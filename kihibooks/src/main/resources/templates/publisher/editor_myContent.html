<!DOCTYPE html>
<html
    xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
    layout:decorate="~{layout/layout.html}">
<head>
    <meta charset="UTF-8">
    <title>KiHiBooks - ì½˜í…ì¸  ê´€ë¦¬</title>
    <style>
        /* í˜ì´ì§€ ê³ ìœ  ìŠ¤íƒ€ì¼ì„ ìœ„í•œ í´ë˜ìŠ¤ */
        .content-management-page h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            border-bottom: 2px solid #ff7f50;
            padding-bottom: 10px;
            font-weight: bold;
        }

        /* ê° ì„¹ì…˜ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .series-container,
        .registration-container {
            margin-top: 30px; /* ì„¹ì…˜ ê°„ ìƒë‹¨ ì—¬ë°± */
            padding: 20px;
            background-color: #f8f9fa; /* ì„¹ì…˜ ë°°ê²½ìƒ‰ */
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
        }

        /* ì„¹ì…˜ ì œëª© ìŠ¤íƒ€ì¼ */
        .series-container h4 {
            color: #34495e;
            margin-top: 0; /* ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì´ë¯€ë¡œ ìƒë‹¨ ë§ˆì§„ ì¡°ì • */
            margin-bottom: 15px;
            font-weight: bold;
        }

        /* ì—°ì¬ ì¤‘ì¸ ì‘í’ˆ ëª©ë¡ ë³¸ë¬¸ ìŠ¤íƒ€ì¼ */
        .series-body {
            /* flexbox, grid ë“±ìœ¼ë¡œ ì‘í’ˆ ì•„ì´í…œë“¤ì„ ë°°ì¹˜í•  ìŠ¤íƒ€ì¼ */
            display: flex; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ ë˜ëŠ” ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒì„ ìœ„í•´ flex ì‚¬ìš© ì˜ˆì‹œ */
            overflow-x: auto; /* ë‚´ìš©ì´ ë„˜ì¹  ê²½ìš° ê°€ë¡œ ìŠ¤í¬ë¡¤ë°” í‘œì‹œ */
            padding-bottom: 15px; /* ìŠ¤í¬ë¡¤ë°” ì—¬ë°± */
            gap: 20px;
            /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ (ì„ íƒ ì‚¬í•­) */
            -ms-overflow-style: auto;  /* IE and Edge */
            scrollbar-width: auto;  /* Firefox */
        }
        .series-body::-webkit-scrollbar { /* Chrome, Safari, Opera */
            display: none;
        }

        /* ì‘í’ˆ ì•„ì´í…œ íŠ¸ë™ (ìŠ¬ë¼ì´ë” ì‚¬ìš© ì‹œ) */
        .series-slider-wrapper {
             /* ìŠ¬ë¼ì´ë” êµ¬í˜„ ì‹œ í™”ì‚´í‘œì™€ íŠ¸ë™ì„ ê°ì‹¸ëŠ” ìŠ¤íƒ€ì¼ */
            display: flex;
             align-items: center; /* ì„¸ë¡œ ê°€ìš´ë° ì •ë ¬ */
             gap: 10px; /* í™”ì‚´í‘œì™€ íŠ¸ë™ ê°„ ê°„ê²© */
        }
        .series-track {
            /* ì‘í’ˆ ì•„ì´í…œë“¤ì´ ë‚˜ì—´ë  ì‹¤ì œ ì˜ì—­ */
            display: flex; /* ì•„ì´í…œë“¤ì„ ê°€ë¡œë¡œ ë‚˜ì—´ */
            gap: 20px; /* ì•„ì´í…œ ê°„ ê°„ê²© */
            overflow-x: auto; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ */
            padding-bottom: 10px;
            /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ (ì„ íƒ ì‚¬í•­) */
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .series-track::-webkit-scrollbar {
            display: none;
        }


        /* ê°œë³„ ì‘í’ˆ ì•„ì´í…œ ìŠ¤íƒ€ì¼ */
        .series-item {
            flex: 0 0 180px; /* ì•„ì´í…œ ë„ˆë¹„ ê³ ì • (ì˜ˆì‹œ), flex-shrink: 0ìœ¼ë¡œ ì¤„ì–´ë“¤ì§€ ì•Šê²Œ */
            width: 180px; /* ì•„ì´í…œ ê³ ì • ë„ˆë¹„ */
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background-color: #fff;
            /* text-align: center; */
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            cursor: pointer; /* í´ë¦­ ê°€ëŠ¥ í‘œì‹œ */
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .series-item:hover {
            transform: translateY(-5px); /* í˜¸ë²„ ì‹œ ì‚´ì§ ìœ„ë¡œ */
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        }

        .series-item h5 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #2c3e50;
            font-size: 1.1rem;
            white-space: nowrap; /* ì œëª©ì´ ê¸¸ë©´ ì¤„ë°”ê¿ˆ ë°©ì§€ */
            overflow: hidden; /* ë„˜ì¹˜ëŠ” ë‚´ìš© ìˆ¨ê¹€ */
            text-overflow: ellipsis; /* ë„˜ì¹˜ëŠ” ë‚´ìš© ... ìœ¼ë¡œ í‘œì‹œ */
        }

        .series-item p {
            margin-bottom: 5px;
            color: #555;
            font-size: 0.9rem;
        }
        .series-item .status {
            font-weight: bold;
            color: #ff7f50; /* ì—°ì¬ ì¤‘ ê°•ì¡°ìƒ‰ ì˜ˆì‹œ */
        }
        .series-item .status.finished {
            color: #6c757d; /* ì™„ê²° ìƒíƒœ ìƒ‰ìƒ ì˜ˆì‹œ */
        }

        /* ì‘í’ˆ ë“±ë¡ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        .registration-container {
             text-align: center; /* ë²„íŠ¼ ê°€ìš´ë° ì •ë ¬ */
        }

        /* ì‘í’ˆ ë“±ë¡ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .orenge-btn {
            padding: 6px 20px;
            font-size: 1rem;
            background-color: #ff7f50; /* ê°•ì¡° ìƒ‰ìƒ ì˜ˆì‹œ */
            color: white;
            border: none;
            border-radius: .25rem;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .orenge-btn:hover {
            background-color: #ff6347;
            color: #fff;
        }
        .modal-item {
            flex: 0 0 180px; /* ì•„ì´í…œ ë„ˆë¹„ ê³ ì • (ì˜ˆì‹œ), flex-shrink: 0ìœ¼ë¡œ ì¤„ì–´ë“¤ì§€ ì•Šê²Œ */
            width: 500px; /* ì•„ì´í…œ ê³ ì • ë„ˆë¹„ */
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background-color: #fff;
            /* text-align: center; */
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .center-img {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

    </style>
</head>
<body>
	<main layout:fragment="content">
        <!-- í˜ì´ì§€ ê³ ìœ  í´ë˜ìŠ¤ ì¶”ê°€ -->
		<div class="container content-management-page">

			<h2 class="mb-3">ğŸ“– ì½˜í…ì¸  ê´€ë¦¬</h2>
            <p>ì—ë””í„°ë‹˜ì´ ë‹´ë‹¹í•˜ê±°ë‚˜ ë“±ë¡í•˜ì‹  ì‘í’ˆ(ë„ì„œ ì‹œë¦¬ì¦ˆ)ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            <!-- 1. ë‹´ë‹¹ ì‘í’ˆ ë¦¬ìŠ¤íŠ¸ ì„¹ì…˜ (ì—°ì¬ ì¤‘ì¸ ì‘í’ˆ) -->
            <div class="series-container">
                <h4>ì—°ì¬ ì¤‘ì¸ ì‘í’ˆ</h4>
                <div class="series-body">
                    <th:block th:if="${books != null and !books.isEmpty()}">
                        <div class="series-item" th:each="work : ${books}" th:data-title="${work.bo_title}" th:data-author="${work.bo_author}" th:data-code="${work.bo_code}" th:data-fin="${work.bo_fin}" th:data-description="${work.bo_description}">
                            <div data-toggle="modal" data-target="#workModal">
                                <h5 th:text="${work.bo_title}">ì‘í’ˆ ì œëª©</h5>
                                <img class="mt-1" src="/resources/static/img/default_thumb.png" alt="ì¸ë„¤ì¼" style="height: 150px;">
                                <p class="mt-2" th:text="${work.bo_author}">ì €ìëª…</p>
                                <!-- <p>ì´ <span th:text="${work.bo_episode_count != null ? work.bo_episode_count : '0'}">0</span>í™”</p> ì´ íšŒì°¨ ìˆ˜ í•„ë“œëª… í™•ì¸ -->
                                <p><span class="status" th:classappend="${work.bo_fin == 'Y' ? 'finished' : ''}" th:text="${work.bo_fin == 'Y' ? 'ì™„ê²°' : 'ì—°ì¬ ì¤‘'}">ì—°ì¬ ì¤‘</span></p>
                                <!-- í´ë¦­ ì‹œ í•´ë‹¹ ì‘í’ˆì˜ íšŒì°¨ ê´€ë¦¬ í˜ì´ì§€ë¡œ ì´ë™ ë˜ëŠ” ëª¨ë‹¬/AJAX ë¡œë“œ -->
                            </div>
                        </div>
                    </th:block>
                    <!-- ì—°ì¬ ì¤‘ì¸ ì‘í’ˆì´ ì—†ì„ ë•Œ ë©”ì‹œì§€ -->
                    <th:block th:unless="${books != null and !books.isEmpty()}">
                        <p class="text-center" style="width: 100%;">í˜„ì¬ ì—°ì¬ ì¤‘ì¸ ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </th:block>
                </div>
            </div>
            <hr>
            <!-- 2. ì‘í’ˆ ë“±ë¡ ì„¹ì…˜ -->
            <div class="registration-container">
                <h3>ìƒˆë¡œìš´ ì‘í’ˆ ë“±ë¡</h3>
                <p>ìƒˆë¡œìš´ ë„ì„œ ì‹œë¦¬ì¦ˆë¥¼ ë“±ë¡í•˜ë ¤ë©´ ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</p>
                <button class="orenge-btn" type="button" onclick="location.href='/editor/registerNew'">ì‘í’ˆ ë“±ë¡</button>
            </div>
            <!-- TODO: íšŒì°¨ ëª©ë¡ ë° ë“±ë¡/ìˆ˜ì •/ì‚­ì œ/ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥ ì„¹ì…˜ì€ ë³„ë„ì˜ í˜ì´ì§€ (/editor/episodes?boCode=...) ì—ì„œ êµ¬í˜„í•˜ê±°ë‚˜,
                        ì´ í˜ì´ì§€ í•˜ë‹¨ì— ìˆ¨ê²¨ì§„ ì„¹ì…˜ìœ¼ë¡œ ë‘ê³  'series-item' í´ë¦­ ì‹œ AJAXë¡œ ë‚´ìš©ì„ ë¡œë“œí•˜ì—¬ ë³´ì—¬ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. -->
            
            <!-- ë‹´ë‹¹ ì‘í’ˆ í´ë¦­ì‹œ ëª¨ë‹¬ -->
            <div class="modal" id="workModal">
                <div class="modal-dialog ">
                    <div class="modal-content modal-item">
                        <!-- Modal Header -->
                        <div class="modal-header">
                            <h4 class="modal-title">ë„ì„œ ì •ë³´</h4>
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>
                        
                        <!-- Modal body -->
                        <div class="modal-body">
                            <p><strong>ì‘í’ˆ ì œëª© : </strong> <span id="modalBoTitle"></span></p>
                            <img class="mt-1 mb-3 center-img" src="/resources/static/img/default_thumb.png" alt="ì¸ë„¤ì¼" style="height: 150px;">
                            <p><strong>ì €ì:</strong> <span id="modalBoAuthor"></span></p>
                            <p><strong>ìƒíƒœ:</strong> <span id="modalBoFin"></span></p>
                            <p>
                                <strong>ë‚´ìš©:</strong>
                                <span id="modalBoDescription"></span>
                                <span id="toggleMoreBtn" style="color: #ff7f50; cursor: pointer; display: none;"> ë”ë³´ê¸°</span>
                            </p>
                            <input type="hidden" name="modalBoCode" id="modalBoCode">
                        </div>
                        
                        <!-- Modal footer -->
                        <div class="modal-footer">
                            <div class="btn orenge-btn" id="registerEpisodeBtn">íšŒì°¨ ë“±ë¡</div>
                            <div class="btn orenge-btn" id="updateBookInfoBtn">ìˆ˜ì •</div>
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">ë‹«ê¸°</button>
                        </div>
                    </div>
                </div>
            </div>
		</div>
        <script>
            $(document).ready(function () {
                const maxLength = 100; // ìµœëŒ€ í‘œì‹œí•  ê¸€ì ìˆ˜
                $('.series-item').on('click', function () {
                    const boTitle = $(this).data('title');
                    const boAuthor = $(this).data('author');
                    const boFin = $(this).data('fin') === 'Y' ? 'ì™„ê²°' : 'ì—°ì¬ ì¤‘';
                    const boDescription = $(this).data('description');
                    const boCode = $(this).data('code');

                    $('#modalBoTitle').text(boTitle);
                    $('#modalBoAuthor').text(boAuthor);
                    $('#modalBoFin').text(boFin);
                    $('#modalBoCode').val(boCode);

                    // ë”ë³´ê¸° ê¸°ëŠ¥ ì ìš©
                    if (boDescription.length > maxLength) {
                        const shortText = boDescription.substring(0, maxLength) + '...';
                        $('#modalBoDescription').text(shortText).data('full', boDescription).data('short', shortText);
                        $('#toggleMoreBtn').text(' ë”ë³´ê¸°').show();
                    } else {
                        $('#modalBoDescription').text(boDescription);
                        $('#toggleMoreBtn').hide();
                    }
                    //íšŒì°¨ë“±ë¡ ë²„íŠ¼
                    $("#registerEpisodeBtn").on("click", function(){
                        window.location.href = "/editor/registerEpisode/" + boCode;
                    })
                    //ìˆ˜ì • ë²„íŠ¼
                    $("#updateBookInfoBtn").on("click", function(){
                        window.location.href = "/editor/updateBookInfo/" + boCode;
                    })
                });

                $('#toggleMoreBtn').on('click', function () {
                    const descSpan = $('#modalBoDescription');
                    const isShort = $(this).text().includes('ë”ë³´ê¸°');

                    if (isShort) {
                        descSpan.text(descSpan.data('full'));
                        $(this).text(' ì ‘ê¸°');
                    } else {
                        descSpan.text(descSpan.data('short'));
                        $(this).text(' ë”ë³´ê¸°');
                    }
                });

                $('#workModal').on('hidden.bs.modal', function () {
                    document.activeElement.blur();
                });
            });
        </script>

	</main>


</body>
</html>
